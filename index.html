<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sonic Command - Anniversary Edition</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root { 
            --gold: #FFD700; 
            --gold-glow: rgba(255, 215, 0, 0.4); 
        }
        
        body {
            margin: 0; background: #000;
            font-family: 'Orbitron', sans-serif;
            background: radial-gradient(circle at center, #0f172a 0%, #000 100%);
            color: white; overflow-x: hidden;
        }

        .cinzel { font-family: 'Cinzel', serif; }

        /* Molduras de Energia Otimizadas */
        .energy-conduit {
            position: fixed; top: 0; width: 6px; height: 100%;
            background: linear-gradient(to bottom, transparent, var(--gold), transparent);
            box-shadow: 0 0 20px var(--gold); z-index: 1000;
        }

        /* Efeito de Vidro Futurista */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 215, 0, 0.2);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.8);
        }

        /* Planeta / Core Principal */
        .planet-glow { 
            box-shadow: 0 0 100px rgba(255, 215, 0, 0.15), inset 0 0 60px rgba(0,0,0,1); 
            background: radial-gradient(circle at 30% 30%, #1a1a1a 0%, #000 100%);
        }

        .floating { animation: float 6s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-20px); } }

        /* Custom Range Slider */
        input[type=range] { -webkit-appearance: none; background: rgba(255,255,255,0.1); height: 6px; border-radius: 5px; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 20px; width: 20px;
            background: var(--gold); border-radius: 50%; cursor: pointer;
            box-shadow: 0 0 10px var(--gold); border: 2px solid white;
        }

        .crystal-path { clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%); }
        
        /* Scanlines para o LCD */
        .lcd-overlay {
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), 
                        linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            background-size: 100% 3px, 3px 100%;
            pointer-events: none;
        }

        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: var(--gold); border-radius: 10px; }
    </style>
</head>
<body>
    <div class="energy-conduit left-0"></div>
    <div class="energy-conduit right-0"></div>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const STREAM_URL = "https://stream.zeno.fm/wzcgaal0dnltv";
        
        const THEMES = [
            { id: 'royal', name: 'Imperial Gold', primary: '#FFD700', glow: '#FFFACD' },
            { id: 'nebula', name: 'Deep Nebula', primary: '#a855f7', glow: '#e9d5ff' },
            { id: 'cyan', name: 'Cyber Blue', primary: '#06b6d4', glow: '#a5f3fc' },
            { id: 'emerald', name: 'Bio Core', primary: '#10b981', glow: '#d1fae5' },
            { id: 'ruby', name: 'Nova Red', primary: '#ef4444', glow: '#fee2e2' }
        ];

        // --- SUB-COMPONENTES ---

        const Gauge = ({ label, value, color }) => (
            <div className="flex flex-col items-center group">
                <div className="relative w-20 h-20 flex items-center justify-center rounded-full border-2 border-white/10 glass-panel">
                    <svg className="w-full h-full transform -rotate-90">
                        <circle cx="40" cy="40" r="35" stroke="currentColor" strokeWidth="3" fill="transparent" className="text-white/5" />
                        <circle cx="40" cy="40" r="35" stroke={color} strokeWidth="3" fill="transparent" 
                                strokeDasharray={220} strokeDashoffset={220 - (value * 220)}
                                style={{ transition: 'stroke-dashoffset 0.5s ease-out' }} />
                    </svg>
                    <span className="absolute text-[10px] font-bold" style={{ color }}>{Math.round(value * 100)}%</span>
                </div>
                <span className="text-[8px] mt-2 tracking-tighter opacity-60 uppercase">{label}</span>
            </div>
        );

        const EnergyCore = ({ analyser, theme, isPlaying }) => {
            const canvasRef = useRef(null);
            
            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                let animationFrame;
                const bufferLength = 64;
                const dataArray = new Uint8Array(bufferLength);

                const draw = () => {
                    const { width, height } = canvas;
                    const cx = width / 2;
                    const cy = height / 2;
                    
                    if (analyser && isPlaying) {
                        analyser.getByteFrequencyData(dataArray);
                    } else {
                        for(let i=0; i<bufferLength; i++) dataArray[i] = 20 + Math.random() * 5;
                    }

                    ctx.clearRect(0, 0, width, height);
                    
                    // Desenhar Aura Central
                    const gradient = ctx.createRadialGradient(cx, cy, 0, cx, cy, 150);
                    gradient.addColorStop(0, `${theme.primary}44`);
                    gradient.addColorStop(1, 'transparent');
                    ctx.fillStyle = gradient;
                    ctx.beginPath();
                    ctx.arc(cx, cy, 150, 0, Math.PI * 2);
                    ctx.fill();

                    // Desenhar Partículas de Áudio
                    for (let i = 0; i < bufferLength; i++) {
                        const barHeight = dataArray[i] * 0.8;
                        const angle = (i * Math.PI * 2) / bufferLength;
                        const x1 = cx + Math.cos(angle) * 100;
                        const y1 = cy + Math.sin(angle) * 100;
                        const x2 = cx + Math.cos(angle) * (100 + barHeight);
                        const y2 = cy + Math.sin(angle) * (100 + barHeight);

                        ctx.strokeStyle = theme.primary;
                        ctx.lineWidth = 3;
                        ctx.lineCap = 'round';
                        ctx.beginPath();
                        ctx.moveTo(x1, y1);
                        ctx.lineTo(x2, y2);
                        ctx.stroke();
                    }
                    animationFrame = requestAnimationFrame(draw);
                };
                draw();
                return () => cancelAnimationFrame(animationFrame);
            }, [analyser, theme, isPlaying]);

            return <canvas ref={canvasRef} width={400} height={400} className="w-full h-full opacity-80" />;
        };

        const App = () => {
            const [isPlaying, setIsPlaying] = useState(false);
            const [volume, setVolume] = useState(0.7);
            const [theme, setTheme] = useState(THEMES[0]);
            const [isOnline, setIsOnline] = useState(navigator.onLine);
            const [analyser, setAnalyser] = useState(null);
            
            const audioRef = useRef(null);
            const audioCtxRef = useRef(null);

            const handlePlay = () => {
                if (!audioCtxRef.current) {
                    const AudioContext = window.AudioContext || window.webkitAudioContext;
                    const ctx = new AudioContext();
                    const audio = new Audio(STREAM_URL);
                    audio.crossOrigin = "anonymous";
                    
                    const source = ctx.createMediaElementSource(audio);
                    const analyserNode = ctx.createAnalyser();
                    analyserNode.fftSize = 128;
                    
                    source.connect(analyserNode);
                    analyserNode.connect(ctx.destination);
                    
                    audioRef.current = audio;
                    audioCtxRef.current = ctx;
                    setAnalyser(analyserNode);
                }

                if (isPlaying) {
                    audioRef.current.pause();
                } else {
                    audioCtxRef.current.resume();
                    audioRef.current.play();
                }
                setIsPlaying(!isPlaying);
            };

            useEffect(() => {
                if(audioRef.current) audioRef.current.volume = volume;
                if(window.lucide) window.lucide.createIcons();
            }, [volume, isPlaying]);

            return (
                <div className="min-h-screen flex flex-col items-center justify-center p-6 gap-12">
                    
                    {/* Header Minimalista */}
                    <header className="text-center z-10">
                        <h1 className="cinzel text-4xl md:text-6xl font-black tracking-tighter text-white drop-shadow-2xl">
                            SONIC <span style={{color: theme.primary}}>COMMAND</span>
                        </h1>
                        <p className="text-[10px] tracking-[0.5em] opacity-50 mt-2 uppercase font-bold">Protocolo de Aniversário // 02 Anos</p>
                    </header>

                    <div className="flex flex-col lg:flex-row items-center gap-12 max-w-6xl w-full">
                        
                        {/* Sidebar Temas */}
                        <div className="glass-panel p-6 rounded-3xl w-full lg:w-64 order-2 lg:order-1">
                            <h2 className="text-[10px] font-black opacity-40 mb-4 uppercase tracking-widest">Temas de Interface</h2>
                            <div className="grid grid-cols-1 gap-2">
                                {THEMES.map(t => (
                                    <button key={t.id} onClick={() => setTheme(t)} 
                                        className={`flex items-center gap-3 p-3 rounded-xl transition-all ${theme.id === t.id ? 'bg-white/10 border border-white/20' : 'hover:bg-white/5'}`}>
                                        <div className="w-3 h-3 rounded-full" style={{background: t.primary}} />
                                        <span className="text-xs font-bold uppercase">{t.name}</span>
                                    </button>
                                ))}
                            </div>
                        </div>

                        {/* Player Central */}
                        <div className="relative w-[320px] h-[320px] md:w-[500px] md:h-[500px] rounded-full planet-glow border-4 border-white/10 flex items-center justify-center order-1 lg:order-2">
                            <div className="absolute inset-0 p-8">
                                <EnergyCore analyser={analyser} theme={theme} isPlaying={isPlaying} />
                            </div>
                            
                            {/* Overlay de Controle */}
                            <div className="z-20 flex flex-col items-center gap-6">
                                <button onClick={handlePlay} 
                                    className="w-24 h-24 rounded-full bg-white flex items-center justify-center text-black shadow-[0_0_30px_rgba(255,255,255,0.4)] hover:scale-105 active:scale-95 transition-transform">
                                    {isPlaying ? <i data-lucide="pause" fill="currentColor"></i> : <i data-lucide="play" fill="currentColor" className="ml-1"></i>}
                                </button>
                                
                                <div className="text-center">
                                    <div className="flex items-center gap-2 justify-center mb-1">
                                        <div className={`w-2 h-2 rounded-full ${isOnline ? 'bg-green-500 animate-pulse' : 'bg-red-500'}`} />
                                        <span className="text-[10px] font-black tracking-widest opacity-80">{isOnline ? 'ESTAÇÃO ATIVA' : 'OFFLINE'}</span>
                                    </div>
                                    <input type="range" min="0" max="1" step="0.01" value={volume} onChange={(e) => setVolume(e.target.value)} className="w-32" />
                                </div>
                            </div>
                        </div>

                        {/* Sensores Direita */}
                        <div className="glass-panel p-8 rounded-[3rem] flex flex-row lg:flex-col gap-8 order-3">
                            <Gauge label="Sinal" value={isOnline ? 0.98 : 0} color={theme.primary} />
                            <Gauge label="Estabilidade" value={isPlaying ? 0.85 : 0.1} color={theme.primary} />
                            <Gauge label="Volume" value={volume} color="#fff" />
                        </div>
                    </div>

                    {/* Footer Nav */}
                    <nav className="fixed bottom-8 glass-panel px-8 py-4 rounded-full flex gap-8 z-[100] border border-white/10">
                        <i data-lucide="radio" className="w-5 h-5 opacity-50 hover:opacity-100 cursor-pointer"></i>
                        <i data-lucide="cpu" className="w-5 h-5 opacity-50 hover:opacity-100 cursor-pointer text-yellow-400"></i>
                        <i data-lucide="shield" className="w-5 h-5 opacity-50 hover:opacity-100 cursor-pointer"></i>
                        <i data-lucide="settings" className="w-5 h-5 opacity-50 hover:opacity-100 cursor-pointer"></i>
                    </nav>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
